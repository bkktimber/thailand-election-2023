import { useEffect, useState } from 'react';
import Layout from '@/components/Layout';
import Head from 'next/head';
import IntroPolicy from '@/components/Landing/IntroPolicy';
import HotTopicPolicy from '@/components/Landing/HotTopicPolicy';
import ByTopic from '@/components/Landing/ByTopic';
import ByParty from '@/components/Landing/ByParty';
import { TheyWorkForUs } from '@thailand-election-2023/database';
import { Party } from '@thailand-election-2023/database/src/models/party';

export default function Landing() {
	const [hotParties, setHotParties] = useState<Party[]>();

	const fetchData = async (): Promise<void> => {
		const data: Party[] = await TheyWorkForUs.Parties.fetchAll({
			where: '(PartyType,eq,พรรค)',
		});
		//mock get hot parties
		setHotParties(data.slice(0, 8));
	};
	useEffect(() => {
		fetchData();
	}, []);
	return (
		<>
			<Head>
				<title>policyshop</title>
				<meta name="description" content="Generated by create next app" />
				<meta name="viewport" content="width=device-width, initial-scale=1" />
			</Head>
			<main>
				<Layout title="landing">
					<IntroPolicy />
					<HotTopicPolicy />
					<ByTopic />
					<ByParty parties={hotParties} />
				</Layout>
			</main>
		</>
	);
}
